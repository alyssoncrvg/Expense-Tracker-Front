<div class="flex h-screen bg-gray-100">

  @if (isMobileMenuOpen()) {
    <div 
      class="fixed inset-0 bg-black/50 z-20 md:hidden transition-opacity"
      (click)="toggleMobileMenu()"
    ></div>
  }

  <div class="md:hidden fixed w-full top-0 z-10 bg-white shadow-sm h-16 flex items-center px-4">
    <button (click)="toggleMobileMenu()" class="text-gray-600 hover:text-blue-600 focus:outline-none">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
      </svg>
    </button>
    <span class="ml-4 text-xl font-bold text-blue-600">Expense</span>
  </div>

  <aside 
    class="bg-white shadow-md flex flex-col transition-all duration-300 ease-in-out
           fixed inset-y-0 left-0 z-30
           md:static md:translate-x-0"
    [class.translate-x-0]="isMobileMenuOpen()"
    [class.-translate-x-full]="!isMobileMenuOpen()"
    [class.w-64]="!isDesktopCollapsed()"
    [class.w-20]="isDesktopCollapsed()"
  >
    
    <div class="h-16 flex items-center justify-between px-4 border-b border-gray-200">
      
      <div class="flex items-center gap-2 overflow-hidden whitespace-nowrap">
        <span class="text-2xl">ðŸ’°</span>
        @if (!isDesktopCollapsed()) {
          <h1 class="text-2xl font-bold text-blue-600 transition-opacity duration-300">
            Expense
          </h1>
        }
      </div>

      <button 
        (click)="toggleDesktopCollapse()" 
        class="hidden md:flex text-gray-400 hover:text-blue-600 focus:outline-none"
      >
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 transition-transform duration-300" 
             [class.rotate-180]="isDesktopCollapsed()"
             fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 19l-7-7 7-7m8 14l-7-7 7-7" />
        </svg>
      </button>
    </div>

    <nav class="flex-1 p-4 space-y-2 overflow-x-hidden">
      <a 
        routerLink="/dashboard" 
        routerLinkActive="bg-blue-50 text-blue-600" 
        (click)="closeMobileMenu()"
        class="flex items-center gap-3 px-3 py-3 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors group"
        [title]="isDesktopCollapsed() ? 'Dashboard' : ''"
      >
        <div class="shrink-0">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="7" height="7"></rect><rect x="14" y="3" width="7" height="7"></rect><rect x="14" y="14" width="7" height="7"></rect><rect x="3" y="14" width="7" height="7"></rect></svg>
        </div>
        
        <span class="font-medium whitespace-nowrap transition-all duration-300"
              [class.opacity-0]="isDesktopCollapsed()"
              [class.hidden]="isDesktopCollapsed()"
              [class.md:block]="!isDesktopCollapsed()">
          Dashboard
        </span>
      </a>

      <a 
        routerLink="/gastos" 
        routerLinkActive="bg-blue-50 text-blue-600" 
        (click)="closeMobileMenu()"
        class="flex items-center gap-3 px-3 py-3 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors group"
        [title]="isDesktopCollapsed() ? 'Gastos' : ''"
      >
        <div class="shrink-0">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 1v22M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path></svg>
        </div>
        <span class="font-medium whitespace-nowrap transition-all duration-300"
              [class.opacity-0]="isDesktopCollapsed()"
              [class.hidden]="isDesktopCollapsed()"
              [class.md:block]="!isDesktopCollapsed()">
          Gastos
        </span>
      </a>
    </nav>

    <div class="p-4 border-t border-gray-200">
      <button 
        (click)="logout()" 
        class="w-full flex items-center gap-3 px-3 py-3 text-red-600 rounded-lg hover:bg-red-50 transition-colors"
        [title]="isDesktopCollapsed() ? 'Sair' : ''"
      >
        <div class="shrink-0">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path><polyline points="16 17 21 12 16 7"></polyline><line x1="21" y1="12" x2="9" y2="12"></line></svg>
        </div>
        <span class="font-medium whitespace-nowrap transition-all duration-300"
              [class.opacity-0]="isDesktopCollapsed()"
              [class.hidden]="isDesktopCollapsed()"
              [class.md:block]="!isDesktopCollapsed()">
          Sair
        </span>
      </button>
    </div>
  </aside>

  <main class="flex-1 overflow-y-auto p-8 pt-20 md:pt-8 transition-all duration-300">
    <router-outlet></router-outlet>
  </main>
</div>